# デプロイ手順（ロリポップ / Nginx + LiteSpeed / Python 3.7）

最終更新日: 2025-10-18

本ドキュメントは、UDC2025をロリポップ環境にデプロイするための一般的な手順例です。実際の手順は契約プラン/サーバー設定により異なります。

## 1. 前提
- リポジトリ: GitHub（後日作成）
- Python: 3.7.17（サーバー）
- アプリ: Flask 2.2.5（`requirements_server.txt`に合わせる）

## 2. デプロイ方式の選定
- 選択肢:
  - WSGI（uWSGI/gunicorn等）+ Nginx（リバースプロキシ）
  - FastCGI/LSAPI（LiteSpeed連携）
  - CGI（最終手段）
- ロリポップの提供機能/プランに依存。サポートドキュメントを確認。

## 3. ディレクトリ構成（例）
```
app/
  wsgi.py
  app/  # Flaskアプリ
public/
  static/
logs/
venv/  # サーバー提供のPythonを使う場合は省略
```

## 4. 必要ファイル
- wsgi.py: Flaskアプリのエントリポイント
- requirements.txt: 可能な限りサーバーのバージョンに固定
- webサーバー設定: .htaccess/専用管理画面でのルーティング設定

## 5. リリース手順（例）
1. GitHubにpush
2. サーバーへデプロイ（Git pull / SFTP / 管理画面）
3. 依存の整合性確認（サーバー側の事前インストールを利用）
4. WSGI/FCGI設定を反映し再起動
5. 動作確認（/healthcheck 等）

## 6. ログ・監視
- アクセスログ、アプリログ（RotatingFileHandler）

## 7. トラブルシュート
- 500エラー: wsgi.pyのパス/権限、Pythonバージョン差異
- 502/504: タイムアウト、バックエンド起動失敗
- 文字化け: エンコーディング/レスポンスヘッダ

## 8. セキュリティ
- 環境変数で秘密情報管理（.envはGitに含めない）
- HTTPS必須（証明書はロリポップ管理）
